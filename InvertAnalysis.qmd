---
title: "InvertebratesAnalysis"
author: "Trevor Harrington"
format: html
editor: visual
execute: 
  keep-md: TRUE
---

# Invertebrate Biodiversity in Riffle-Pool Streams: The Influence of Water Flow Characteristics.

```{r}
#Load all valuable libraries to manipulate and display data
library(readxl)
library(tidyverse)
library(kableExtra)
library(ggplot2)
library(tidymodels)
library(janitor)
library(magrittr)

#data is saved locally, not accessable off of this PC
invertebrates <- read_excel("Invertebrates in R/inverts_class_data.xlsx") %>%
  
clean_names() 


```

## Initial Data Split/ finding a hypothesis

```{r}
   # Initial data intake / hypothesis generating exploration before further data investigation.
   
   my_data_splits <- initial_split(invertebrates, prop = 0.5,
                                   pool = 1) 

exploratory_data <- training(my_data_splits)
test_data <- testing(my_data_splits)



```

```{r}
invertebrates %>%
  
  pivot_longer(cols = 6:23,
               names_to = "order",
               values_to = "count") %>%
  
  filter_if(vars('count' == 0)) # did not work, try below or mutate


filter (count !> 0)

  kable() %>%
    kable_styling(bootstrap_options = c("hover", "striped"))
```

Considering Hypothesis on Initial Data Split

### Potential Questions for Investigation

Investigation of raw data suggests some potential questions could be related to a preference of species towards one type of stream versus another, with potentially some variation of these four testing sites providing an environment that is suitably favorable for a range of species.

This data has some significant limitations that prevent a in-depth investigation of the cause for success over one species versus another. Namely, this data lacks temporal, geographical, and methodology data that could provide insight for what other variables may contribute to the data collected. This data also lacks any measurement units for flow rate and width/depth, meaning they do not provide sufficient data to make any assumptions on the actual size, depth, or total flow of the stream to contribute in analysis. Overall, this data will be most valuable for

-   How are the characteristics between Site 1 & 2 different? Which combination of features seems to be the most ideal for invertebrate success.

    -   Is large species count the same as biodiversity? Does the site with largest amount of species also have the most unique species, or is favorable for only a few?

    ```{r}
    invertebrates %>%
      
       pivot_longer(invertebrates,
                   cols = 6:23,
                   names_to = "order",
                   values_to = "count") %>%
      
      
      

      
    ```

```{r}
invertebrates %>% #simple exploratory analysis 
  
  mutate(total_individuals_present = bivalvia + diptera + turbellaria + oliggocheata + hirundinea + decapoda + amphipod + isopod + trombidiforme + plecoptera + trichoptera + ephemroptera + megaloptera + coleoptera + hemiptera + odonta + lepidoptera) %>%

mutate(flow_volume_m_sqrd = stream_width * stream_depth * flow_velocity) %>%
  
  group_by(site, riffle_pool) %>%
  
summarise(
  "average species present" = mean(total_individuals_present),
  "'Unit' flow" = mean(flow_volume_m_sqrd),
  "Riffle/pool" = list(riffle_pool),
  ) %>%

kable() %>%
  kable_styling(bootstrap_options = c("hover", "striped"))


```

#### Viewing Distribution of Species Across Sites

**Hypotheses:**

**NULL Hypothesis:** Characteristics
